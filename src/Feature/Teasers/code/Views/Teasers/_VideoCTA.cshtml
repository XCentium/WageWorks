@model Vista.Feature.Teasers.Models.CallToActionLinkModel
@using Vista.Foundation.SitecoreExtensions.Extensions

@if (Model.IsVideoPopup)
{
    <section class="modal fade video-modal popup" id="modal-@Model.Id" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <section class="promo full yt__player content-center">
                        <div class="yt__video" data-yt-id="@Model.Url.ToYoutubeId()"></div>
                        <div class="yt__screenshot">
                            <div class="promo__background" style="background-image: url('@Model.BackgroundImage');"></div>


                            <div class="promo__content-wrapper container">
                                <div class="promo__content">
                                    <div class="promo__ctas">
                                        @if (!string.IsNullOrEmpty(Model.Name))
                                        {
                                            <h2>@Model.Title</h2>
                                        }

                                        @if (!string.IsNullOrEmpty(Model.Text))
                                        {
                                            <div class="promo__copy">
                                                @Html.Raw(Model.Text)
                                            </div>
                                        }

                                        <a href="#" target="" class="btn yt__play">
                                            <i class="icon icon-cta"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                </div>
            </div>
        </div>
    </section>

    <script type="text/javascript">
        var callback = function () {
            $('#modal-@Model.Id').on('hidden.bs.modal', function () {
                $('#modal-@Model.Id .yt__player').each(function () {
                    var elem = $(this);
                    if (elem.data('ytPlayer')) {
                        var p = elem.data('ytPlayer');
                        p.stopPlayer();
                    }
                });
            })
        }

        if (document.readyState === "complete" ||
            (document.readyState !== "loading" && !document.documentElement.doScroll)) {
            callback();
        } else {
            document.addEventListener("DOMContentLoaded", callback);
        }
    </script>

}